!function(a){"use strict";a(document).on("click.fx.ajax",".tsdelete",function(){var e=a(this);if(!e.data("url"))return fx.msg("请指定data-url属性"),!1;var t,s=e.data("table");t=s?a(s):e.closest(".uitable");var l=a.extend({confirm:"确定要删除当前记录吗?",loadMask:!0,loadMaskDelay:200,loadMaskTarget:t[0],loadMaskMessage:"正在删除数据,请稍等..."},e.data()),r=function(s){if(fx.loadMask.hide(l),s.success){t.uitable().reload();var r=e.data("successCallback");r&&(a.isFunction(r)?r.call(e[0]):r.toFunction().call(e[0]))}else fx.alert(s.message)},o={url:l.url,type:"post",cache:!1,data:e.data("data"),dataType:"json",beforeSend:function(){fx.loadMask.show(l)},error:function(a){fx.loadMask.hide(l),fx.ajaxFailAlert(a)},success:r};return fx.confirm(l.confirm,function(e){layer.close(e),a.ajax(o)}),!1}),a(document).on("click.fx.ajax",".tmdelete",function(){var e=a(this),t=e.data("table");if(!e.data("url"))return fx.msg("请指定data-url属性"),!1;if(!t)return fx.msg("请指定data-table属性"),!1;var s=a(t),l=s.uitable().getSelectedIds();if(0==l.length)return fx.msg("请选择需要删除的记录"),!1;var r=a.extend({loadMask:!0,loadMaskDelay:200,loadMaskTarget:s[0],loadMaskMessage:"正在删除数据,请稍等..."},e.data());e.data("confirm")||(r.confirm='确定要删除选中的 <span class="color-danger"> '+l.length+"</span> 条记录吗?");var o=a.extend({},e.data("data"),{id:l.join()}),n=function(t){if(fx.loadMask.hide(r),t.success){s.uitable().reload();var l=e.data("successCallback");l&&(a.isFunction(l)?l.call(e[0]):l.toFunction().call(e[0]))}else fx.alert(t.message)},c={url:r.url,type:"post",cache:!1,data:o,dataType:"json",beforeSend:function(){fx.loadMask.show(r)},error:function(a){fx.loadMask.hide(r),fx.ajaxFailAlert(a)},success:n};return fx.confirm(r.confirm,function(e){layer.close(e),a.ajax(c)}),!1}),a(document).on("click.fx.ajax",".treedelete",function(){var e=a(this);if(!e.data("url"))return fx.msg("请指定data-url属性"),!1;var t=e.data("tree");if(!t)return fx.msg("请指定data-tree属性"),!1;var s=a(t),l=a.extend({confirm:"确定要删除选中的节点以及子节点吗?",loadMask:!0,loadMaskDelay:200,loadMaskTarget:s[0],loadMaskMessage:"正在删除数据,请稍等..."},e.data()),r=s.uitree().getSelected(),o=a.extend({},e.data("data"),{id:r.id}),n=function(t){if(fx.loadMask.hide(l),t.success){s.uitree().remove(r.target);var o=e.data("table");o&&a(o).uitable().clearRows();var n=e.data("successCallback");n&&(a.isFunction(n)?n.call(e[0]):n.toFunction().call(e[0]))}else fx.alert(t.message)},c={url:l.url,type:"post",cache:!1,data:o,dataType:"json",beforeSend:function(){fx.loadMask.show(l)},error:function(a){fx.loadMask.hide(l),fx.ajaxFailAlert(a)},success:n};return fx.confirm(l.confirm,function(e){layer.close(e),a.ajax(c)}),!1})}(jQuery);